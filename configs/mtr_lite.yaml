model:
  d_model: 256
  nhead: 8
  num_encoder_layers: 4
  num_decoder_layers: 4
  dim_feedforward: 1024
  dropout: 0.1
  num_intentions: 64
  num_modes_output: 6
  future_len: 80
  max_agents: 32
  max_map_polylines: 64
  max_targets: 8
  agent_feat_dim: 29
  map_feat_dim: 9
  map_points_per_lane: 20
  nms_dist_thresh: 2.0

data:
  scene_list: /home/xingnan/projects/scenario-dreamer/scene_list_123k_signal_ssd.txt
  data_fraction: 0.2
  history_len: 11
  future_len: 80
  anchor_frames: [10]
  max_agents: 32
  max_map_polylines: 64
  map_points_per_lane: 20
  neighbor_distance: 50.0
  val_ratio: 0.15
  augment: true
  augment_rotation: true

training:
  batch_size: 4
  gradient_accumulation: 8
  lr: 1.0e-4
  weight_decay: 0.01
  warmup_epochs: 5
  max_epochs: 60
  precision: "16-mixed"
  gradient_clip_val: 1.0
  num_workers: 8
  output_dir: /mnt/hdd12t/outputs/mtr_lite/
  checkpoint_every_n_epochs: 5
  log_every_n_steps: 50

loss:
  cls_weight: 1.0
  reg_weight: 1.0
  deep_supervision_weights: [0.2, 0.2, 0.2, 0.4]

seed: 42
