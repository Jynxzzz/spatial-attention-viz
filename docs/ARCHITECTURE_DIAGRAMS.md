# Spatial Attention Visualization - Architecture Diagrams

**Project**: MTR-Lite Attention Visualization
**Created**: 2026-02-10

---

## Diagram 1: System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            DATA LOADING                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Waymo pkl Scene File                                                â”‚   â”‚
â”‚  â”‚  â€¢ 91 frames @ 10Hz                                                  â”‚   â”‚
â”‚  â”‚  â€¢ Objects: [{id, type, pos, heading, vel, bbox, ...}]              â”‚   â”‚
â”‚  â”‚  â€¢ lane_graph: NetworkX graph with centerlines                      â”‚   â”‚
â”‚  â”‚  â€¢ traffic_lights: [...]                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚                                               â”‚
â”‚                             â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PolylineDataset                                                     â”‚  â”‚
â”‚  â”‚  â€¢ Extract agent polylines (A, 11, 29)                               â”‚  â”‚
â”‚  â”‚  â€¢ Extract map polylines (M, 20, 9)                                  â”‚  â”‚
â”‚  â”‚  â€¢ Transform to ego frame                                            â”‚  â”‚
â”‚  â”‚  â¤ Output: batch dict                                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   TOKEN-SPACE MAPPING (NEW!)                                â”‚
â”‚                             â”‚                                               â”‚
â”‚                             â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SpatialTokenBookkeeper.from_batch(batch)                            â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  FOR each agent in batch:                                            â”‚  â”‚
â”‚  â”‚      Extract: pos_bev, heading, velocity from features               â”‚  â”‚
â”‚  â”‚      Register: token_idx â†’ (pos, heading, bbox)                      â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  FOR each lane in batch:                                             â”‚  â”‚
â”‚  â”‚      Extract: centerline_bev from map_polylines                      â”‚  â”‚
â”‚  â”‚      Register: token_idx â†’ (centerline, bbox)                        â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  â¤ Build: agent_tokens{}, map_tokens{}                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MODEL INFERENCE                                      â”‚
â”‚                             â”‚                                               â”‚
â”‚                             â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  MTRLite(batch, capture_attention=True)                              â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  1. PolylineEncoder (PointNet)                                       â”‚  â”‚
â”‚  â”‚     agent_polylines (A,11,29) â†’ agent_tokens (A, 256)                â”‚  â”‚
â”‚  â”‚     map_polylines (M,20,9) â†’ map_tokens (M, 256)                     â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  2. SceneEncoder (4 layers self-attention)                           â”‚  â”‚
â”‚  â”‚     all_tokens (96, 256) â†’ encoded_tokens (96, 256)                  â”‚  â”‚
â”‚  â”‚     â˜… Capture: scene_attentions[layer] = (B, 8, 96, 96)              â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  3. MotionDecoder (64 queries, 4 layers)                             â”‚  â”‚
â”‚  â”‚     queries (64, 256) + encoded_tokens â†’ trajectories (K, 80, 2)     â”‚  â”‚
â”‚  â”‚     â˜… Capture: decoder_agent_attn, decoder_map_attn                  â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  â¤ Output: {trajectories, scores, attention_maps}                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SPATIAL HEATMAP GENERATION                                 â”‚
â”‚                             â”‚                                               â”‚
â”‚                             â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Extract Attention Weights                                           â”‚  â”‚
â”‚  â”‚  scene_attn = attention_maps.scene_attentions[-1][0]  # Last layer   â”‚  â”‚
â”‚  â”‚  query_token_idx = bookkeeper.agent_token_ranges[ego_idx][0]         â”‚  â”‚
â”‚  â”‚  attn_weights = scene_attn.mean(dim=0)[query_token_idx]  # (96,)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                               â”‚
â”‚                             â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  bookkeeper.get_spatial_map(attn_weights, resolution=0.5, radius=60) â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  1. Create empty heatmap (240, 240)                                  â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  2. FOR token_idx in [0, 31]:  # Agent tokens                        â”‚  â”‚
â”‚  â”‚        IF token_idx in bookkeeper.agent_tokens:                      â”‚  â”‚
â”‚  â”‚            pos = agent_tokens[token_idx]['pos']                      â”‚  â”‚
â”‚  â”‚            weight = attn_weights[token_idx]                          â”‚  â”‚
â”‚  â”‚            gaussian_splat_2d(heatmap, pos, weight, sigma=3.0)        â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  3. FOR token_idx in [32, 95]:  # Map tokens                         â”‚  â”‚
â”‚  â”‚        IF token_idx in bookkeeper.map_tokens:                        â”‚  â”‚
â”‚  â”‚            centerline = map_tokens[token_idx]['centerline']          â”‚  â”‚
â”‚  â”‚            weight = attn_weights[token_idx]                          â”‚  â”‚
â”‚  â”‚            paint_polyline_2d(heatmap, centerline, weight, width=2.0) â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  â¤ Return: heatmap (240, 240), extent (-60, 60, -60, 60)            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MULTI-LAYER RENDERING                                  â”‚
â”‚                             â”‚                                               â”‚
â”‚                             â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  render_attention_overlay_bev(...)                                   â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  fig, ax = plt.subplots(figsize=(12, 12))                            â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  Layer 0: ax.grid (faint background)                                 â”‚  â”‚
â”‚  â”‚  Layer 1: draw_lanes(ax, scene)  # Gray dashed lines                â”‚  â”‚
â”‚  â”‚  Layer 2: draw_traffic_lights(ax, scene)  # Colored squares          â”‚  â”‚
â”‚  â”‚  Layer 3: draw_vehicles(ax, batch, neighbor=True)  # Gray rectangles â”‚  â”‚
â”‚  â”‚  Layer 4: ax.imshow(heatmap, alpha=0.6, cmap='magma')  â˜…â˜…â˜…          â”‚  â”‚
â”‚  â”‚  Layer 5: draw_vehicle(ax, ego_pos, ego_heading, color='blue')       â”‚  â”‚
â”‚  â”‚  Layer 6: draw_trajectories(ax, pred, gt)  # Cyan + green lines      â”‚  â”‚
â”‚  â”‚  Layer 7: add_top3_highlights(ax, attn_weights)  # Cyan circles      â”‚  â”‚
â”‚  â”‚  Layer 8: plt.colorbar, ax.legend, ax.set_title                      â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚  plt.savefig(save_path, dpi=300, bbox_inches='tight')                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Diagram 2: Gaussian Splatting Algorithm

```
Input: center = (10.5, -3.2) meters in BEV
       weight = 0.85 (attention)
       sigma = 3.0 meters

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: Convert BEV coordinates to grid indices                â”‚
â”‚                                                                 â”‚
â”‚   BEV: X âˆˆ [-60, 60], Y âˆˆ [-60, 60]  (meters)                  â”‚
â”‚   Grid: Row âˆˆ [0, 240], Col âˆˆ [0, 240]  (pixels)               â”‚
â”‚                                                                 â”‚
â”‚   cx = (center[0] + 60) / 0.5 = (10.5 + 60) / 0.5 = 141        â”‚
â”‚   cy = (center[1] + 60) / 0.5 = (-3.2 + 60) / 0.5 = 114        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: Compute patch bounds (3Ïƒ rule)                         â”‚
â”‚                                                                 â”‚
â”‚   sigma_px = sigma / resolution = 3.0 / 0.5 = 6 pixels         â”‚
â”‚   patch_radius = 3 * sigma_px = 18 pixels                      â”‚
â”‚                                                                 â”‚
â”‚   x_min = cx - 18 = 123                                        â”‚
â”‚   x_max = cx + 18 = 159                                        â”‚
â”‚   y_min = cy - 18 = 96                                         â”‚
â”‚   y_max = cy + 18 = 132                                        â”‚
â”‚                                                                 â”‚
â”‚   Patch size: 36Ã—36 = 1296 pixels (only render this region!)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: Create meshgrid for patch                              â”‚
â”‚                                                                 â”‚
â”‚   xx, yy = meshgrid(range(123, 159), range(96, 132))           â”‚
â”‚                                                                 â”‚
â”‚   xx[0,0] = 123    xx[0,1] = 124    ...    xx[0,35] = 158      â”‚
â”‚   yy[0,0] = 96     yy[1,0] = 97     ...    yy[35,0] = 131      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: Compute Gaussian kernel                                â”‚
â”‚                                                                 â”‚
â”‚   dist_sq = (xx - cx)Â² + (yy - cy)Â²                            â”‚
â”‚                                                                 â”‚
â”‚   Example:                                                      â”‚
â”‚   At (cx, cy) = (141, 114): dist_sq = 0 â†’ exp(0) = 1.0         â”‚
â”‚   At (145, 114): dist_sq = 16 â†’ exp(-16/(2*36)) = 0.80         â”‚
â”‚   At (159, 114): dist_sq = 324 â†’ exp(-324/72) = 0.011          â”‚
â”‚                                                                 â”‚
â”‚   gaussian = exp(-dist_sq / (2 * sigma_pxÂ²))                   â”‚
â”‚            = exp(-dist_sq / 72)                                 â”‚
â”‚                                                                 â”‚
â”‚   Shape: (36, 36) with peak 1.0 at center                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: Accumulate weighted Gaussian to heatmap                â”‚
â”‚                                                                 â”‚
â”‚   heatmap[96:132, 123:159] += weight * gaussian                â”‚
â”‚                            += 0.85 * gaussian                   â”‚
â”‚                                                                 â”‚
â”‚   Result: Bright spot at (141, 114) with smooth falloff        â”‚
â”‚                                                                 â”‚
â”‚   Peak value: 0.85 (at center)                                 â”‚
â”‚   Edge value: 0.85 * 0.011 = 0.009 (at 3Ïƒ boundary)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Visual Representation (cross-section):

    ^
1.0 â”‚        â•±â•²               Peak = 0.85
0.8 â”‚      â•±    â•²
0.6 â”‚    â•±        â•²            Ïƒ = 6 pixels
0.4 â”‚  â•±            â•²
0.2 â”‚â•±                â•²
0.0 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    123  129  135  141  147  153  159  (pixels)
         â†â”€ 3Ïƒ â”€â†’ â†â”€ 3Ïƒ â”€â†’
```

---

## Diagram 3: Polyline Painting Algorithm

```
Input: centerline = [(x0,y0), (x1,y1), ..., (xN,yN)]  # Lane polyline
       weight = 0.62 (attention)
       width = 2.0 meters

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: Resample polyline densely                              â”‚
â”‚                                                                 â”‚
â”‚   Original: N=20 points, spacing ~5 meters                     â”‚
â”‚   Resampled: Mâ‰ˆ400 points, spacing ~0.25 meters                â”‚
â”‚                                                                 â”‚
â”‚   Why? Ensures continuous painting even for curved lanes       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: Convert all points to grid coordinates                 â”‚
â”‚                                                                 â”‚
â”‚   grid_points = coords_to_grid(dense_polyline, res=0.5, r=60)  â”‚
â”‚                                                                 â”‚
â”‚   Example:                                                      â”‚
â”‚   (-10.0, 5.0) â†’ (130, 100)                                     â”‚
â”‚   (-9.75, 5.1) â†’ (131, 100)                                     â”‚
â”‚   ...                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: Draw each segment with thickness                       â”‚
â”‚                                                                 â”‚
â”‚   width_px = width / resolution = 2.0 / 0.5 = 4 pixels         â”‚
â”‚                                                                 â”‚
â”‚   FOR i in range(len(grid_points) - 1):                        â”‚
â”‚       p1, p2 = grid_points[i], grid_points[i+1]                â”‚
â”‚       draw_thick_line(heatmap, p1, p2, weight, width_px=4)     â”‚
â”‚                                                                 â”‚
â”‚   draw_thick_line uses anti-aliased Bresenham + dilation       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Visual Representation (top view):

Straight lane:
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      â† width = 4 pixels = 2.0m â†’

Curved lane:
         â•­â”€â”€â”€â”€â”€â”€â”€â•®
         â”‚       â”‚  Maintains uniform width around curves
         â•°â”€â”€â”€â”€â”€â”€â”€â•¯

Intersection (multiple lanes painted):
    â•‘
    â•‘
  â•â•â•¬â•â•â•â•â•  High attention (bright)
    â•‘
    â•‘       Low attention (dim)
    â”€ â”€ â”€
```

---

## Diagram 4: Coordinate Transform Chain

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        WORLD FRAME                                 â”‚
â”‚  â€¢ Origin: Arbitrary Waymo coordinate system                       â”‚
â”‚  â€¢ Scale: Meters                                                   â”‚
â”‚  â€¢ Example: Agent at (12345.6, 67890.1, 3.2)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ [Translation: -ego_pos]
                 â”‚ [Rotation: -ego_heading]
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         EGO FRAME                                  â”‚
â”‚  â€¢ Origin: Ego vehicle at anchor frame (t=10)                      â”‚
â”‚  â€¢ Orientation: Ego heading aligned to +X axis                     â”‚
â”‚  â€¢ Scale: Meters                                                   â”‚
â”‚  â€¢ Example: Agent at (10.5, -3.2)  (10.5m forward, 3.2m right)    â”‚
â”‚  â€¢ This is the BEV frame used throughout the project              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ [Discretization: / resolution]
                 â”‚ [Shift: + radius]
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        GRID FRAME                                  â”‚
â”‚  â€¢ Origin: Bottom-left corner (with matplotlib origin='lower')     â”‚
â”‚  â€¢ Orientation: Col = X, Row = Y                                   â”‚
â”‚  â€¢ Scale: Pixels (0.5 meters per pixel)                            â”‚
â”‚  â€¢ Size: 240Ã—240 (for radius=60m, resolution=0.5m/px)              â”‚
â”‚  â€¢ Example: Agent at (141, 114)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ [matplotlib imshow with extent]
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       DISPLAY FRAME                                â”‚
â”‚  â€¢ matplotlib figure                                               â”‚
â”‚  â€¢ extent = (-60, 60, -60, 60) maps grid to BEV coordinates       â”‚
â”‚  â€¢ User sees BEV coordinates on axes                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Transform Functions:

1. World â†’ Ego (done by dataset during loading):
   pos_ego = Rotate(-ego_heading) @ (pos_world - ego_pos)

2. Ego â†’ Grid (spatial_utils.coords_to_grid):
   col = (x_ego + radius) / resolution
   row = (y_ego + radius) / resolution

3. Grid â†’ Ego (spatial_utils.grid_to_coords):
   x_ego = col * resolution - radius
   y_ego = row * resolution - radius

4. Display (matplotlib extent parameter):
   imshow(..., extent=(-radius, radius, -radius, radius))
```

---

## Diagram 5: Multi-Layer Rendering Z-Order

```
                        FINAL IMAGE
                             â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Z = 8: Annotations â”‚   â”‚  Z = 7: Predicted â”‚
    â”‚   â€¢ Top-3 highlights â”‚   â”‚  trajectories     â”‚
    â”‚   â€¢ Attention labels â”‚   â”‚  (cyan lines)     â”‚
    â”‚   â€¢ Text boxes       â”‚   â”‚                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Z = 6: GT Trajectoryâ”‚   â”‚ Z = 5: Ego Vehicleâ”‚
    â”‚  (green dashed line) â”‚   â”‚ (blue rectangle)  â”‚
    â”‚                      â”‚   â”‚ alpha = 0.9       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                         â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚       Z = 4: ATTENTION HEATMAP (KEY!)           â”‚
    â”‚       â€¢ magma colormap                          â”‚
    â”‚       â€¢ alpha = 0.6 (semi-transparent)          â”‚
    â”‚       â€¢ interpolation = 'bilinear'              â”‚
    â”‚       â€¢ 240Ã—240 grid, extent (-60,60,-60,60)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     Z = 3: Neighbor Vehicles                    â”‚
    â”‚     â€¢ Gray rectangles                           â”‚
    â”‚     â€¢ Oriented bounding boxes                   â”‚
    â”‚     â€¢ alpha = 0.7                               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     Z = 2: Traffic Lights                       â”‚
    â”‚     â€¢ Colored squares (red/yellow/green)        â”‚
    â”‚     â€¢ Size: 2Ã—2 meters                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     Z = 1: Lane Centerlines                     â”‚
    â”‚     â€¢ Gray dashed lines                         â”‚
    â”‚     â€¢ linewidth = 1.5                           â”‚
    â”‚     â€¢ linestyle = '--'                          â”‚
    â”‚     â€¢ alpha = 0.6                               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     Z = 0: Grid Background                      â”‚
    â”‚     â€¢ Faint gray grid                           â”‚
    â”‚     â€¢ alpha = 0.3                               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Alpha Blending Example:

Without heatmap (Z=4 removed):
    â•‘         â•‘
    â•‘   ğŸš—   â•‘  â† Clear vehicles
  â•â•â•¬â•â•â•â•â•â•â•â•â•â•¬â•â•
    â•‘         â•‘

With heatmap (Z=4 at alpha=0.6):
    â•‘  ğŸ”¥ğŸ”¥ğŸ”¥  â•‘
    â•‘ ğŸš—[glow]â•‘  â† Vehicles visible through semi-transparent heatmap
  â•â•â•¬ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥â•¬â•â•
    â•‘  ğŸ”¥ğŸ”¥ğŸ”¥  â•‘

Key insight: Alpha=0.6 allows seeing both the heatmap AND underlying scene elements
```

---

## Diagram 6: Token Bookkeeper Data Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SpatialTokenBookkeeper                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  agent_tokens: Dict[int, Dict]                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 0: {pos: [0.0, -20.0], heading: 1.57, bbox: [...]}            â”‚ â”‚
â”‚  â”‚ 1: {pos: [10.5, -3.2], heading: 0.0, bbox: [...]}             â”‚ â”‚
â”‚  â”‚ 2: {pos: [-15.0, 5.0], heading: -0.5, bbox: [...]}            â”‚ â”‚
â”‚  â”‚ ...                                                            â”‚ â”‚
â”‚  â”‚ 31: {pos: [20.0, 10.0], heading: 3.14, bbox: [...]}           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â†‘                                                              â”‚
â”‚      â”‚ token_idx                                                    â”‚
â”‚      â”‚                                                              â”‚
â”‚  map_tokens: Dict[int, Dict]                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 32: {centerline: [(-5,-30), (-5,30)], lane_id: "lane_001"}    â”‚ â”‚
â”‚  â”‚ 33: {centerline: [(5,30), (5,-30)], lane_id: "lane_002"}      â”‚ â”‚
â”‚  â”‚ 34: {centerline: [(-30,-5), (30,-5)], lane_id: "lane_003"}    â”‚ â”‚
â”‚  â”‚ ...                                                            â”‚ â”‚
â”‚  â”‚ 95: {centerline: [...], lane_id: "lane_064"}                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â†‘                                                              â”‚
â”‚      â”‚ token_idx                                                    â”‚
â”‚                                                                     â”‚
â”‚  agent_token_ranges: Dict[int, Tuple[int, int]]                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 0: (0, 1)    # Ego vehicle â†’ token 0                          â”‚ â”‚
â”‚  â”‚ 1: (1, 2)    # Agent 1 â†’ token 1                              â”‚ â”‚
â”‚  â”‚ ...                                                            â”‚ â”‚
â”‚  â”‚ 31: (31, 32) # Agent 31 â†’ token 31                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â†‘                                                              â”‚
â”‚      â”‚ agent_idx                                                    â”‚
â”‚                                                                     â”‚
â”‚  map_token_ranges: Dict[int, Tuple[int, int]]                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 0: (32, 33)  # Map 0 â†’ token 32                               â”‚ â”‚
â”‚  â”‚ 1: (33, 34)  # Map 1 â†’ token 33                               â”‚ â”‚
â”‚  â”‚ ...                                                            â”‚ â”‚
â”‚  â”‚ 63: (95, 96) # Map 63 â†’ token 95                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â†‘                                                              â”‚
â”‚      â”‚ map_idx                                                      â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Query Example:

Given: attention_weights = [0.30, 0.85, 0.45, ..., 0.62, ...]  # (96,)
Want:  Where to render token 5's attention (0.45)?

Step 1: Lookup token 5 in agent_tokens
  â¤ agent_tokens[5] = {pos: [10.5, -3.2], heading: 0.0, ...}

Step 2: Extract position
  â¤ pos = [10.5, -3.2] (in BEV meters)

Step 3: Splat Gaussian at pos with weight 0.45
  â¤ gaussian_splat_2d(heatmap, pos, 0.45, sigma=3.0)

Result: Attention rendered spatially at correct vehicle position!
```

---

## Diagram 7: Comparison - Before and After Training

```
UNTRAINED MODEL (Random Weights):

    Attention Heatmap              BEV Overlay
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚            â”‚   â–“â–“â•‘â–“â–“â–“â–“â–“â•‘â–“â–“   â”‚
    â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚            â”‚ â–“â–“â–“â–“â•‘â–“â–“â–“â–“â–“â•‘â–“â–“â–“â–“ â”‚
    â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚            â”‚â•â•â–“â–“â–“â•¬â–“â–“â–“â–“â–“â•¬â–“â–“â–“â•â•â”‚
    â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚            â”‚ â–“â–“â–“â–“â•‘ğŸš—â–“â–“â–“â•‘â–“â–“â–“â–“ â”‚
    â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚            â”‚   â–“â–“â•‘â–“â–“â–“â–“â–“â•‘â–“â–“   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    Uniform attention              No clear pattern
    Entropy: ~6.5 bits             (Model doesn't know
                                    where to look)

           â–¼â–¼â–¼ TRAINING (60 epochs) â–¼â–¼â–¼

TRAINED MODEL (After 60 epochs):

    Attention Heatmap              BEV Overlay
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        ğŸ”¥        â”‚            â”‚      ğŸ”¥â•‘â–“â–“â–“â–“â–“â•‘   â”‚
    â”‚      ğŸ”¥ğŸ”¥ğŸ”¥      â”‚            â”‚    ğŸ”¥ğŸ”¥â•‘â–“â–“ğŸš—â–“â•‘   â”‚
    â”‚  ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥  â”‚            â”‚â•â•ğŸ”¥ğŸ”¥ğŸ”¥â•¬ğŸ”¥ğŸ”¥ğŸ”¥â•¬â•â•â”‚
    â”‚      ğŸ”¥ğŸš—ğŸ”¥      â”‚            â”‚    â–“â–“â–“â•‘â–“Egoâ–“â•‘   â”‚
    â”‚        â–“        â”‚            â”‚      â–“â•‘â–“â–“â–“â–“â–“â•‘   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    Focused attention              Clear attention to:
    Entropy: ~3.0 bits             - Oncoming (ğŸ”¥)
                                   - Target lane (ğŸ”¥)
                                   (Model learned!)

Key Observations:
âœ“ Entropy decreases: More focused
âœ“ Spatial structure emerges: Attention aligns with traffic logic
âœ“ Interpretable: Can see WHY model makes predictions
âœ“ Debugging: Failure cases show attention misallocation
```

---

## Diagram 8: Use Cases for Paper

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       FIGURE 1 (Main Contribution)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   BEV Scene    â”‚   Attention    â”‚   Overlay      â”‚              â”‚
â”‚  â”‚                â”‚   Heatmap      â”‚   (Combined)   â”‚              â”‚
â”‚  â”‚   ğŸš—  ğŸš™       â”‚                â”‚   ğŸ”¥ğŸ”¥ğŸ”¥        â”‚              â”‚
â”‚  â”‚   â•â•â•â•â•â•â•â•     â”‚   ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥    â”‚   â•‘ğŸ”¥ğŸš—ğŸ”¥â•‘      â”‚              â”‚
â”‚  â”‚   â•‘     â•‘      â”‚   ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥    â”‚   â•‘ğŸ”¥ğŸ”¥ğŸ”¥â•‘      â”‚              â”‚
â”‚  â”‚                â”‚                â”‚   â•â•â•â•â•â•â•â•     â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚  Caption: "Attention visualization enables spatial interpretation" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FIGURE 4 (Qualitative Results)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚Intersect.â”‚ Highway  â”‚   VRU    â”‚  6 diverse scenarios           â”‚
â”‚  â”‚   ğŸ”¥     â”‚  â•ğŸ”¥â•    â”‚  ğŸš¶ğŸ”¥    â”‚  All with attention overlay    â”‚
â”‚  â”‚ â•â•¬ğŸ”¥â•¬â•   â”‚  â•â•â•     â”‚  ğŸš—      â”‚  Demonstrates generality       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚ Complex  â”‚ Failure  â”‚Train/Untrâ”‚                                â”‚
â”‚  â”‚ ğŸš—ğŸš—ğŸ”¥ğŸš—  â”‚  ğŸš—  âœ—   â”‚ Before/  â”‚                                â”‚
â”‚  â”‚ â•â•¬â•â•¬â•    â”‚  â•â•¬â•     â”‚ After    â”‚                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  FIGURE 6 (Failure Case Analysis)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ Success Case         â”‚ Failure Case         â”‚                   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚  â”‚ Predicted: âœ         â”‚ Predicted: â†‘         â”‚                   â”‚
â”‚  â”‚ GT: âœ               â”‚ GT: â†               â”‚                   â”‚
â”‚  â”‚ Attention: ğŸ”¥ (lane)â”‚ Attention: ğŸ”¥ (wrong)â”‚                   â”‚
â”‚  â”‚ âœ“ Correct focus     â”‚ âœ— Missed target lane â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚  Insight: Failure visualized as spatial attention mismatch          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SUPPLEMENTARY (GIF Animation)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ Frame 1 (Layer 0): Broad attention      â”‚                       â”‚
â”‚  â”‚ â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“                            â”‚                       â”‚
â”‚  â”‚      â†“                                  â”‚                       â”‚
â”‚  â”‚ Frame 2 (Layer 1): Starting to focus    â”‚                       â”‚
â”‚  â”‚ â–“â–“ğŸ”¥ğŸ”¥â–“â–“                                â”‚                       â”‚
â”‚  â”‚      â†“                                  â”‚                       â”‚
â”‚  â”‚ Frame 3 (Layer 2): More focused         â”‚                       â”‚
â”‚  â”‚   ğŸ”¥ğŸ”¥ğŸ”¥                                 â”‚                       â”‚
â”‚  â”‚      â†“                                  â”‚                       â”‚
â”‚  â”‚ Frame 4 (Layer 3): Sharp focus          â”‚                       â”‚
â”‚  â”‚    ğŸ”¥ğŸ”¥                                  â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚  Shows iterative refinement of attention across layers              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**End of Diagrams**
**Version**: 1.0
**Total Diagrams**: 8
